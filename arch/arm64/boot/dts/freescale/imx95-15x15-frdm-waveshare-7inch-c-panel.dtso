// SPDX-License-Identifier: (GPL-2.0+ OR MIT)
/*
 * Copyright 2025 NXP
 */

#include "imx95-clock.h"
#include "imx95-pinfunc.h"

/dts-v1/;
/plugin/;

&{/} {
	panel {
		compatible = "waveshare,7.0inch-c-panel", "panel-dpi";
		power-supply = <&reg_5p0v>;

		port {
			panel_to_waveshare: endpoint {
				remote-endpoint = <&waveshare_to_panel>;
			};
		};

		panel-timing {
			clock-frequency = <50000000>;
			hactive = <1024>;
			vactive = <600>;
			hfront-porch = <100>;
			hback-porch = <100>;
			hsync-len = <100>;
			vback-porch = <10>;
			vfront-porch = <10>;
			vsync-len = <10>;

			hsync-active = <0>;
			vsync-active = <0>;
			de-active = <1>;
			pixelclk-active = <1>;
		};
	};
};

&dpu {
	assigned-clocks = <&scmi_clk IMX95_CLK_DISP1PIX>,
			  <&scmi_clk IMX95_CLK_VIDEOPLL1_VCO>,
			  <&scmi_clk IMX95_CLK_VIDEOPLL1>;
	assigned-clock-parents = <&scmi_clk IMX95_CLK_VIDEOPLL1>;
	assigned-clock-rates = <0>, <3000000000>, <500000000>;
};

&lpi2c4 {
	#address-cells = <1>;
	#size-cells = <0>;

	touchscreen@14 {
		compatible = "goodix,gt911";
		reg = <0x14>;
		touchscreen-size-x = <800>;
		touchscreen-size-y = <480>;
	};

	bridge@45 {
		compatible = "waveshare,dsi2dpi";
		reg = <0x45>;
		power-supply = <&reg_5p0v>;

		ports {
			#address-cells = <1>;
			#size-cells = <0>;

			port@0 {
				reg = <0>;

				waveshare_from_dsi: endpoint {
					data-lanes = <1 2>;
					remote-endpoint = <&dsi_to_waveshare>;
				};
			};

			port@1 {
				reg = <1>;

				waveshare_to_panel: endpoint {
					remote-endpoint = <&panel_to_waveshare>;
				};
			};
		};
	};
};

&mipi_dsi {
	status = "okay";

	ports {
		#address-cells = <1>;
		#size-cells = <0>;

		port@1 {
			reg = <1>;

			dsi_to_waveshare: endpoint {
				remote-endpoint = <&waveshare_from_dsi>;
			};
		};
	};
};

&pixel_interleaver {
	#address-cells = <1>;
	#size-cells = <0>;
	status = "okay";

	channel@0 {
		reg = <0>;
		status = "okay";
	};
};

&scmi_iomuxc {
	pinctrl_lpi2c6: lpi2c6grp {
		fsl,pins = <
			IMX95_PAD_GPIO_IO02__LPI2C6_SDA			0x40000b9e
			IMX95_PAD_GPIO_IO03__LPI2C6_SCL			0x40000b9e
		>;
	};
};
